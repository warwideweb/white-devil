<!-- 
  WHITE DEVIL - THE COLLECTION SECTION
  Full rebuild per brief specifications
  Uses GSAP ScrollTrigger for scroll-pinned animations
-->

<!-- Add to <head> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<style>
/* ============================================================================
   THE COLLECTION - CSS CUSTOM PROPERTIES
   ============================================================================ */
:root {
    --leather-dark: #0a0a0a;
    --leather-warm: #0d0b09;
    --leather-mid: #111111;
    --leather-edge: #0e0c0a;
    --stitch-color: rgba(90, 75, 60, 0.6);
    --metal-light: #d4d4d4;
    --metal-dark: #707070;
    --glass-blur: 30px;
    --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
}

/* ============================================================================
   SECTION CONTAINER
   ============================================================================ */
.collection-section {
    position: relative;
    height: 400vh; /* 4x viewport for scroll room */
    background: #000;
}

.collection-pin-wrapper {
    position: sticky;
    top: 0;
    height: 100vh;
    width: 100%;
    overflow: hidden;
    perspective: 2000px;
    perspective-origin: center center;
}

/* ============================================================================
   REVEALED CONTENT (BEHIND THE LEATHER)
   ============================================================================ */
.collection-reveal {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: radial-gradient(ellipse at center, #0a0808 0%, #050505 50%, #000 100%);
    opacity: 0;
    z-index: 1;
}

/* Ambient glow */
.collection-reveal::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80vmin;
    height: 80vmin;
    background: radial-gradient(circle, rgba(255,245,230,0.03) 0%, transparent 70%);
    pointer-events: none;
}

/* Apple Glass Circle */
.glass-showcase {
    position: relative;
    width: clamp(280px, 50vmin, 500px);
    height: clamp(280px, 50vmin, 500px);
    border-radius: 50%;
}

/* Prismatic edge */
.glass-edge {
    position: absolute;
    inset: -2px;
    border-radius: 50%;
    background: conic-gradient(
        from var(--prism-angle, 0deg),
        rgba(255,100,150,0.3),
        rgba(100,200,255,0.4),
        rgba(150,255,200,0.3),
        rgba(255,220,100,0.4),
        rgba(180,100,255,0.3),
        rgba(100,180,255,0.4),
        rgba(255,100,150,0.3)
    );
    padding: 2px;
    -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - 3px), #fff calc(100% - 2px));
    mask: radial-gradient(farthest-side, transparent calc(100% - 3px), #fff calc(100% - 2px));
    opacity: 0.6;
    filter: blur(0.5px);
}

/* Frosted glass surface */
.glass-surface {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: rgba(255,255,255,0.03);
    backdrop-filter: blur(var(--glass-blur)) saturate(150%);
    -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(150%);
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow:
        inset 0 2px 20px rgba(0,0,0,0.5),
        inset 0 -1px 10px rgba(255,255,255,0.02),
        0 0 60px rgba(0,0,0,0.5);
    overflow: hidden;
}

/* Images behind the glass */
.glass-images {
    position: absolute;
    inset: -20px;
    border-radius: 50%;
    overflow: hidden;
}

.glass-image {
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity 1.5s var(--transition-smooth), transform 6s linear;
    transform: scale(1);
}

.glass-image.active {
    opacity: 1;
    transform: scale(1.05);
}

.glass-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Glass reflection */
.glass-reflection {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: linear-gradient(
        135deg,
        rgba(255,255,255,0.12) 0%,
        rgba(255,255,255,0.04) 30%,
        transparent 50%,
        transparent 100%
    );
    pointer-events: none;
}

/* Collection title (revealed) */
.collection-title-revealed {
    margin-top: 40px;
    font-size: clamp(0.8rem, 1.5vw, 1rem);
    font-weight: 300;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: rgba(255,255,255,0.6);
    opacity: 0;
    transform: translateY(20px);
}

/* ============================================================================
   LEATHER PANELS
   ============================================================================ */
.leather-wrapper {
    position: absolute;
    inset: 0;
    display: flex;
    z-index: 10;
    pointer-events: none;
}

.leather-panel {
    flex: 1;
    position: relative;
    transform-style: preserve-3d;
    backface-visibility: hidden;
}

.leather-panel-left {
    transform-origin: left center;
}

.leather-panel-right {
    transform-origin: right center;
}

/* Leather texture - layered approach */
.leather-surface {
    position: absolute;
    inset: 0;
    /* Base color with warm gradient toward center */
    background: linear-gradient(
        90deg,
        var(--leather-dark) 0%,
        var(--leather-mid) 40%,
        var(--leather-warm) 95%,
        var(--leather-edge) 100%
    );
}

.leather-panel-right .leather-surface {
    background: linear-gradient(
        -90deg,
        var(--leather-dark) 0%,
        var(--leather-mid) 40%,
        var(--leather-warm) 95%,
        var(--leather-edge) 100%
    );
}

/* Leather grain texture layer 1 - fine noise */
.leather-grain {
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.06'/%3E%3C/svg%3E");
    opacity: 0.8;
    mix-blend-mode: overlay;
}

/* Leather grain texture layer 2 - larger pores */
.leather-pores {
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='pores'%3E%3CfeTurbulence type='turbulence' baseFrequency='0.4' numOctaves='3' seed='5'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23pores)' opacity='0.04'/%3E%3C/svg%3E");
    opacity: 0.5;
}

/* Different grain direction for left panel */
.leather-panel-left .leather-pores {
    transform: rotate(2deg) scale(1.02);
}

.leather-panel-right .leather-pores {
    transform: rotate(-1deg) scale(1.01);
}

/* Vignette for depth */
.leather-vignette {
    position: absolute;
    inset: 0;
    background: radial-gradient(
        ellipse at center,
        transparent 30%,
        rgba(0,0,0,0.3) 100%
    );
    pointer-events: none;
}

/* Debossed grain highlight */
.leather-highlight {
    position: absolute;
    inset: 0;
    background: linear-gradient(
        160deg,
        rgba(255,255,255,0.02) 0%,
        transparent 30%,
        transparent 70%,
        rgba(0,0,0,0.1) 100%
    );
    pointer-events: none;
}

/* Panel edge thickness */
.leather-panel-left::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 3px;
    height: 100%;
    background: linear-gradient(
        180deg,
        #1a1816 0%,
        #0d0b09 50%,
        #1a1816 100%
    );
    box-shadow: -2px 0 8px rgba(0,0,0,0.8);
}

.leather-panel-right::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 3px;
    height: 100%;
    background: linear-gradient(
        180deg,
        #1a1816 0%,
        #0d0b09 50%,
        #1a1816 100%
    );
    box-shadow: 2px 0 8px rgba(0,0,0,0.8);
}

/* Inner (flesh) side of leather - lighter */
.leather-inner {
    position: absolute;
    inset: 0;
    background: linear-gradient(
        90deg,
        #1c1915 0%,
        #15120f 100%
    );
    transform: rotateY(180deg);
    backface-visibility: hidden;
}

/* ============================================================================
   STITCHING
   ============================================================================ */
.stitch-line {
    position: absolute;
    top: 0;
    width: 3px;
    height: 100%;
    z-index: 15;
}

.leather-panel-left .stitch-line {
    right: 15px;
}

.leather-panel-right .stitch-line {
    left: 15px;
}

/* Saddle stitch pattern */
.stitch-pattern {
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
        180deg,
        transparent 0px,
        transparent 6px,
        var(--stitch-color) 6px,
        var(--stitch-color) 10px,
        transparent 10px,
        transparent 16px
    );
}

/* Stitch indent shadow */
.stitch-shadow {
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
        180deg,
        transparent 0px,
        transparent 5px,
        rgba(0,0,0,0.4) 5px,
        rgba(0,0,0,0.4) 7px,
        transparent 7px,
        transparent 16px
    );
    transform: translateX(1px);
}

/* ============================================================================
   CENTER SEAM & ZIPPER
   ============================================================================ */
.center-seam {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 8px;
    height: 100%;
    z-index: 20;
    background: linear-gradient(
        90deg,
        rgba(0,0,0,0.9) 0%,
        rgba(20,18,16,0.8) 50%,
        rgba(0,0,0,0.9) 100%
    );
    box-shadow: 0 0 20px rgba(0,0,0,0.9);
}

/* Light crack that appears during opening */
.seam-light {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 2px;
    height: 0%;
    background: linear-gradient(
        180deg,
        rgba(255,245,230,0.4) 0%,
        rgba(255,245,230,0.1) 100%
    );
    z-index: 19;
    filter: blur(1px);
    box-shadow: 0 0 15px rgba(255,245,230,0.3);
}

/* Zipper head */
.zipper-head {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 16px;
    height: 24px;
    z-index: 25;
    border-radius: 3px 3px 5px 5px;
    background: linear-gradient(
        180deg,
        var(--metal-light) 0%,
        #b8b8b8 20%,
        var(--metal-dark) 80%,
        #505050 100%
    );
    box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.4),
        0 2px 6px rgba(0,0,0,0.6);
}

/* Zipper pull */
.zipper-pull {
    position: absolute;
    bottom: -12px;
    left: 50%;
    transform: translateX(-50%);
    width: 8px;
    height: 14px;
    background: linear-gradient(
        180deg,
        var(--metal-light) 0%,
        var(--metal-dark) 100%
    );
    border-radius: 2px 2px 4px 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.5);
}

.zipper-pull::after {
    content: '';
    position: absolute;
    top: 4px;
    left: 50%;
    transform: translateX(-50%);
    width: 3px;
    height: 4px;
    border-radius: 1px;
    border: 1px solid rgba(0,0,0,0.3);
}

/* ============================================================================
   TEXT ON LEATHER
   ============================================================================ */
.leather-text-wrapper {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 30;
    text-align: center;
    pointer-events: none;
}

.leather-title {
    font-size: clamp(2rem, 6vw, 4.5rem);
    font-weight: 200;
    letter-spacing: 0.35em;
    text-transform: uppercase;
    color: rgba(255,255,255,0.85);
    text-shadow: 0 2px 10px rgba(0,0,0,0.8);
    white-space: nowrap;
}

/* Split text containers */
.text-left, .text-right {
    display: inline-block;
    overflow: hidden;
}

.text-left {
    clip-path: inset(0 50% 0 0);
}

.text-right {
    clip-path: inset(0 0 0 50%);
    margin-left: -0.35em; /* Compensate for letter-spacing */
}

.leather-subtitle {
    margin-top: 20px;
    font-size: clamp(0.6rem, 1.2vw, 0.85rem);
    letter-spacing: 0.4em;
    text-transform: uppercase;
    color: rgba(255,255,255,0.5);
}

/* ============================================================================
   MOBILE RESPONSIVE
   ============================================================================ */
@media (max-width: 768px) {
    .collection-section {
        height: 350vh;
    }
    
    .glass-showcase {
        width: 70vw;
        height: 70vw;
        max-width: 350px;
        max-height: 350px;
    }
    
    .leather-title {
        font-size: clamp(1.5rem, 8vw, 2.5rem);
        letter-spacing: 0.25em;
    }
}
</style>

<!-- HTML STRUCTURE -->
<section class="collection-section" id="collection-section">
    <div class="collection-pin-wrapper">
        
        <!-- REVEALED CONTENT (behind leather) -->
        <div class="collection-reveal" id="collectionReveal">
            <div class="glass-showcase">
                <div class="glass-edge" id="glassEdge"></div>
                <div class="glass-images" id="glassImages">
                    <div class="glass-image active">
                        <img src="images/product-1.jpg" alt="Product 1">
                    </div>
                    <div class="glass-image">
                        <img src="images/product-2.jpg" alt="Product 2">
                    </div>
                    <div class="glass-image">
                        <img src="images/product-3.jpg" alt="Product 3">
                    </div>
                </div>
                <div class="glass-surface"></div>
                <div class="glass-reflection"></div>
            </div>
            <p class="collection-title-revealed" id="titleRevealed">The Collection</p>
        </div>
        
        <!-- LIGHT CRACK -->
        <div class="seam-light" id="seamLight"></div>
        
        <!-- LEATHER PANELS -->
        <div class="leather-wrapper">
            <div class="leather-panel leather-panel-left" id="leatherLeft">
                <div class="leather-surface"></div>
                <div class="leather-grain"></div>
                <div class="leather-pores"></div>
                <div class="leather-vignette"></div>
                <div class="leather-highlight"></div>
                <div class="leather-inner"></div>
                <div class="stitch-line">
                    <div class="stitch-shadow"></div>
                    <div class="stitch-pattern"></div>
                </div>
            </div>
            <div class="leather-panel leather-panel-right" id="leatherRight">
                <div class="leather-surface"></div>
                <div class="leather-grain"></div>
                <div class="leather-pores"></div>
                <div class="leather-vignette"></div>
                <div class="leather-highlight"></div>
                <div class="leather-inner"></div>
                <div class="stitch-line">
                    <div class="stitch-shadow"></div>
                    <div class="stitch-pattern"></div>
                </div>
            </div>
        </div>
        
        <!-- CENTER SEAM -->
        <div class="center-seam" id="centerSeam"></div>
        
        <!-- ZIPPER HEAD -->
        <div class="zipper-head" id="zipperHead">
            <div class="zipper-pull"></div>
        </div>
        
        <!-- TEXT ON LEATHER -->
        <div class="leather-text-wrapper" id="leatherText">
            <h2 class="leather-title">
                <span class="text-left" id="textLeft">THE COLLECTION</span>
                <span class="text-right" id="textRight">THE COLLECTION</span>
            </h2>
            <p class="leather-subtitle" id="leatherSubtitle">Scroll to Open</p>
        </div>
        
    </div>
</section>

<script>
// ============================================================================
// THE COLLECTION - GSAP SCROLL ANIMATION
// ============================================================================
document.addEventListener('DOMContentLoaded', function() {
    gsap.registerPlugin(ScrollTrigger);
    
    // Elements
    const section = document.getElementById('collection-section');
    const leatherLeft = document.getElementById('leatherLeft');
    const leatherRight = document.getElementById('leatherRight');
    const centerSeam = document.getElementById('centerSeam');
    const seamLight = document.getElementById('seamLight');
    const zipperHead = document.getElementById('zipperHead');
    const collectionReveal = document.getElementById('collectionReveal');
    const leatherText = document.getElementById('leatherText');
    const textLeft = document.getElementById('textLeft');
    const textRight = document.getElementById('textRight');
    const leatherSubtitle = document.getElementById('leatherSubtitle');
    const titleRevealed = document.getElementById('titleRevealed');
    const glassEdge = document.getElementById('glassEdge');
    const glassImages = document.querySelectorAll('.glass-image');
    
    // Create main timeline
    const tl = gsap.timeline({
        scrollTrigger: {
            trigger: section,
            start: 'top top',
            end: 'bottom bottom',
            scrub: 1,
            pin: false,
            // markers: true // Uncomment to debug
        }
    });
    
    // ========== PHASE 1: 0-15% - Zipper starts, subtitle fades ==========
    tl.to(leatherSubtitle, {
        opacity: 0,
        duration: 0.1
    }, 0);
    
    tl.to(zipperHead, {
        top: '30%',
        duration: 0.15
    }, 0);
    
    tl.to(seamLight, {
        height: '25%',
        duration: 0.15
    }, 0);
    
    // ========== PHASE 2: 15-40% - Panels start opening, zipper continues ==========
    tl.to(zipperHead, {
        top: '70%',
        duration: 0.25
    }, 0.15);
    
    tl.to(seamLight, {
        height: '65%',
        duration: 0.25
    }, 0.15);
    
    tl.to(leatherLeft, {
        rotateY: 45,
        duration: 0.25,
        ease: 'power2.out'
    }, 0.15);
    
    tl.to(leatherRight, {
        rotateY: -45,
        duration: 0.25,
        ease: 'power2.out'
    }, 0.15);
    
    // Text starts splitting
    tl.to(textLeft, {
        x: '-20%',
        rotateY: 30,
        duration: 0.25
    }, 0.15);
    
    tl.to(textRight, {
        x: '20%',
        rotateY: -30,
        duration: 0.25
    }, 0.15);
    
    // Reveal starts showing
    tl.to(collectionReveal, {
        opacity: 0.5,
        duration: 0.25
    }, 0.2);
    
    tl.to(centerSeam, {
        opacity: 0.5,
        duration: 0.15
    }, 0.2);
    
    // ========== PHASE 3: 40-70% - Full opening ==========
    tl.to(zipperHead, {
        top: '100%',
        opacity: 0,
        duration: 0.3
    }, 0.4);
    
    tl.to(seamLight, {
        height: '100%',
        opacity: 0,
        duration: 0.3
    }, 0.4);
    
    tl.to(leatherLeft, {
        rotateY: 75,
        x: '-10%',
        duration: 0.3,
        ease: 'power2.out'
    }, 0.4);
    
    tl.to(leatherRight, {
        rotateY: -75,
        x: '10%',
        duration: 0.3,
        ease: 'power2.out'
    }, 0.4);
    
    tl.to(textLeft, {
        x: '-50%',
        rotateY: 60,
        opacity: 0,
        duration: 0.2
    }, 0.4);
    
    tl.to(textRight, {
        x: '50%',
        rotateY: -60,
        opacity: 0,
        duration: 0.2
    }, 0.4);
    
    tl.to(collectionReveal, {
        opacity: 1,
        duration: 0.3
    }, 0.45);
    
    tl.to(centerSeam, {
        opacity: 0,
        duration: 0.2
    }, 0.4);
    
    // ========== PHASE 4: 70-85% - Panels flatten ==========
    tl.to(leatherLeft, {
        rotateY: 88,
        x: '-20%',
        duration: 0.15
    }, 0.7);
    
    tl.to(leatherRight, {
        rotateY: -88,
        x: '20%',
        duration: 0.15
    }, 0.7);
    
    // ========== PHASE 5: 85-100% - Panels fade out ==========
    tl.to([leatherLeft, leatherRight], {
        opacity: 0,
        x: (i) => i === 0 ? '-30%' : '30%',
        duration: 0.15
    }, 0.85);
    
    // Revealed title fades in
    tl.to(titleRevealed, {
        opacity: 1,
        y: 0,
        duration: 0.15
    }, 0.85);
    
    // ========== IMAGE CROSSFADE (timer-based) ==========
    let currentImage = 0;
    const imageInterval = setInterval(() => {
        glassImages.forEach(img => img.classList.remove('active'));
        currentImage = (currentImage + 1) % glassImages.length;
        glassImages[currentImage].classList.add('active');
    }, 5000);
    
    // ========== PRISMATIC EDGE ROTATION ==========
    let prismAngle = 0;
    function animatePrism() {
        prismAngle += 0.5;
        glassEdge.style.setProperty('--prism-angle', prismAngle + 'deg');
        requestAnimationFrame(animatePrism);
    }
    animatePrism();
    
    // ========== MOUSE PARALLAX ON GLASS ==========
    const glassImagesContainer = document.getElementById('glassImages');
    document.addEventListener('mousemove', (e) => {
        const x = (e.clientX / window.innerWidth - 0.5) * 20;
        const y = (e.clientY / window.innerHeight - 0.5) * 20;
        gsap.to(glassImagesContainer, {
            x: x,
            y: y,
            duration: 0.5,
            ease: 'power2.out'
        });
    });
});
</script>
